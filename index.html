<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {
        'packages':['geochart'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
        'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);
		arr = [[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  58  ], 
[ 'Canada',  58  ], 
[ 'United States',  53  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  62  ], 
[ 'Canada',  62  ], 
[ 'United States',  56  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  69  ], 
[ 'Canada',  69  ], 
[ 'United States',  61  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  74  ], 
[ 'Canada',  70  ], 
[ 'United States',  72  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  80  ], 
[ 'Canada',  75  ], 
[ 'United States',  76  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  85  ], 
[ 'Canada',  85  ], 
[ 'United States',  90  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  91  ], 
[ 'Canada',  92  ], 
[ 'United States',  93  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  103  ], 
[ 'Canada',  97  ], 
[ 'United States',  106  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  116  ], 
[ 'Canada',  104  ], 
[ 'United States',  110  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  120  ], 
[ 'Canada',  116  ], 
[ 'United States',  114  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  126  ], 
[ 'Canada',  126  ], 
[ 'United States',  122  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  139  ], 
[ 'Canada',  134  ], 
[ 'United States',  138  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  151  ], 
[ 'Canada',  146  ], 
[ 'United States',  151  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  162  ], 
[ 'Canada',  157  ], 
[ 'United States',  166  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  173  ], 
[ 'Canada',  167  ], 
[ 'United States',  185  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  190  ], 
[ 'Canada',  179  ], 
[ 'United States',  193  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  201  ], 
[ 'Canada',  195  ], 
[ 'United States',  212  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  211  ], 
[ 'Canada',  210  ], 
[ 'United States',  231  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  222  ], 
[ 'Canada',  214  ], 
[ 'United States',  243  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  231  ], 
[ 'Canada',  232  ], 
[ 'United States',  251  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  240  ], 
[ 'Canada',  239  ], 
[ 'United States',  267  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  249  ], 
[ 'Canada',  259  ], 
[ 'United States',  280  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  263  ], 
[ 'Canada',  266  ], 
[ 'United States',  294  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  277  ], 
[ 'Canada',  280  ], 
[ 'United States',  319  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  293  ], 
[ 'Canada',  289  ], 
[ 'United States',  345  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  305  ], 
[ 'Canada',  299  ], 
[ 'United States',  355  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  320  ], 
[ 'Canada',  306  ], 
[ 'United States',  373  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  337  ], 
[ 'Canada',  318  ], 
[ 'United States',  398  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  355  ], 
[ 'Canada',  341  ], 
[ 'United States',  425  ]], 
[['Country', 'Popularity'],
['Germany', 45],
['MX', 350],
[ 'RU',  370  ], 
[ 'Canada',  352  ], 
[ 'United States',  436  ]]
];
	
	    
	var all_data; 
	$.getJSON('us-data.json', function(data) {
    // JSON result in `data` variable
	console.log("DATA RECIEVED--------------------");
	console.log(data);
	all_data = data;
	});
	    
	    
	function get_day_data(data, day)
	    {
		    var x = new Date(2020,1,21);
		    x.setDate(x.getDate()+day);
		    //var Y = x.getYear()+1900;
		    //var M = x.getMonth();
		    //var D = x.getDay();
		    
		    
		    //var str = Y.toString()+"-"+M.toString()+"-"+D.toString();
		    var str = x.toISOString().substr(0,10)
		    var res = [['State', 'Cases']];
		    all_data.forEach(function(row){
			    if (row.date == str)
				    res.push([row.state, row.cases]);
		    });
		    
		    return res;
	    }

	  time = 0
	  first = true
      function drawRegionsMap() {

		
		var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

        <!-- var data = google.visualization.arrayToDataTable([ -->
          <!-- ['Country', 'Popularity'], -->
          <!-- ['Germany', 200], -->
          <!-- ['United States', 300], -->
          <!-- ['Brazil', 400], -->
          <!-- ['Canada', 500], -->
          <!-- ['France', 600], -->
          <!-- ['RU', x] -->
        <!-- ]); -->
		
		console.log(arr[time][0][1])
		console.log(arr[time][1][1])
		console.log(arr[time][2][1])
	      	dayArr = get_day_data(all_data,time);
		var data = google.visualization.arrayToDataTable(dayArr);
		time = time+1;
		
        var options = {
		 region: 'US', 
		 colorAxis: {colors: ['green', 'red']}, 
		  animation:{
			duration: 1000,
			easing: 'out'
		  },
		};

        

		 google.visualization.events.addListener(chart, 'ready',
          function() {
            //button.disabled = false;
          });
		  
        chart.draw(data, options);
		
	    tt = setInterval(function(){
		//drawRegionsMap();
		time = time + 1; 		
		data = google.visualization.arrayToDataTable(arr[time]);
		chart.draw(data, options);
		}, 2000);
		
      }
	  

    </script>
  </head>
  <body>
    <div id="regions_div" style="width: 900px; height: 500px;"></div>
  </body>
</html>
